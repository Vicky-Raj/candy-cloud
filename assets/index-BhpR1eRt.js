import{W as O,E as h,j as e,T as v,B as D,x as $,G as R,o as M,P as H,Z as k,A as F,_ as V,$ as b,a0 as E,n as q}from"./index-Cx0CmI-E.js";import{c as B,u as L,I as A,T as u,f as z,a as W,b as G,d as Y,P as Q,g as U,e as Z,h as _,i as J,N}from"./index-iFBPyHJ6.js";const K=[{returnId:"RET001",orderId:"ORD001",returnDate:"20/01/2023",productName:"Vanilla Swirls",quantity:1,reason:"Damaged item",status:"Approved"},{returnId:"RET002",orderId:"ORD003",returnDate:"15/03/2023",productName:"Strawberry Clouds",quantity:2,reason:"Wrong item received",status:"Pending"},{returnId:"RET003",orderId:"ORD004",returnDate:"18/03/2023",productName:"Minty Fresh",quantity:1,reason:"Changed mind",status:"Rejected"},{returnId:"RET004",orderId:"ORD002",returnDate:"25/02/2023",productName:"Chocolate Dreams",quantity:1,reason:"Not as expected",status:"Processed"},{returnId:"RET005",orderId:"ORD005",returnDate:"05/04/2023",productName:"Caramel Crunch",quantity:1,reason:"Item arrived late",status:"Approved"}];function T(r){if(!r)return null;const a=r.split("/");if(a.length===3){const g=parseInt(a[0],10),p=parseInt(a[1],10)-1,m=parseInt(a[2],10);if(!isNaN(g)&&!isNaN(p)&&!isNaN(m)){const d=new Date(m,p,g);if(d.getFullYear()===m&&d.getMonth()===p&&d.getDate()===g)return d}}return null}const f=B();function X({column:r}){var p,m,d,S;const a=r.getFilterValue(),g=(p=r.columnDef.meta)==null?void 0:p.filterVariant;if(g==="number-range"){const[i,x]=h.useState(!1),I=a==null?void 0:a[0],y=a==null?void 0:a[1],[j,C]=h.useState(I),[s,t]=h.useState(y),n=(m=r.columnDef.meta)==null?void 0:m.rangeMin,o=(d=r.columnDef.meta)==null?void 0:d.rangeMax,c=((S=r.columnDef.meta)==null?void 0:S.rangeStep)??1;return h.useMemo(()=>{i||(C(a==null?void 0:a[0]),t(a==null?void 0:a[1]))},[a,i]),e.jsxs(b,{opened:i,onClose:()=>x(!1),position:"bottom-start",withArrow:!0,shadow:"md",trapFocus:!0,onOpen:()=>{C(a==null?void 0:a[0]),t(a==null?void 0:a[1])},children:[e.jsx(b.Target,{children:e.jsx(F,{variant:i?"filled":r.getIsFiltered()?"light":"default",onClick:()=>x(l=>!l),size:"input-xs",title:`Filter ${r.columnDef.header}`,style:{lineHeight:1},children:e.jsx(A,{size:"1rem"})})}),e.jsx(b.Dropdown,{p:"sm",style:{minWidth:230},children:e.jsxs(D,{children:[e.jsxs(R,{grow:!0,align:"flex-start",gap:"xs",children:[e.jsx(N,{label:"Min",placeholder:n!==void 0?`Min: ${n}`:"Minimum",value:j===void 0?"":j,onChange:l=>C(l===""?void 0:Number(l)),min:n,max:s??o,step:c,size:"xs",variant:"filled",style:{flex:1}}),e.jsx(N,{label:"Max",placeholder:o!==void 0?`Max: ${o}`:"Maximum",value:s===void 0?"":s,onChange:l=>t(l===""?void 0:Number(l)),min:j??n,max:o,step:c,size:"xs",variant:"filled",style:{flex:1}})]}),e.jsxs(R,{justify:"flex-end",mt:"md",children:[e.jsx(M,{variant:"default",size:"xs",onClick:()=>{C(void 0),t(void 0),r.setFilterValue([void 0,void 0]),x(!1)},children:"Clear"}),e.jsx(M,{size:"xs",onClick:()=>{r.setFilterValue([j,s]),x(!1)},children:"Done"})]})]})})]})}if(g==="date-range"){const i=a||[null,null];return e.jsx(E,{type:"range",size:"xs",placeholder:"Pick dates range",value:i,onChange:x=>r.setFilterValue(x),clearable:!0,popoverProps:{withinPortal:!0},style:{minWidth:220}})}return r.id==="status"?e.jsx(V,{size:"xs",placeholder:"Filter by Status",data:["Pending","Approved","Rejected","Processed"].map(i=>({label:i,value:i})),value:a||null,onChange:i=>r.setFilterValue(i),clearable:!0}):e.jsx(q,{size:"xs",placeholder:`Search ${r.columnDef.header}...`,value:a??"",onChange:i=>r.setFilterValue(i.target.value),variant:"filled"})}const ne=function(){const a=O({from:"/customer/$customerId"}),g=(a==null?void 0:a.name)||"Customer",[p,m]=h.useState([]),[d,S]=h.useState([]),[i,x]=h.useState({pageIndex:0,pageSize:5}),I=h.useMemo(()=>[f.accessor("returnId",{header:"Return ID",cell:t=>t.getValue()}),f.accessor("orderId",{header:"Order ID",cell:t=>t.getValue()}),f.accessor("returnDate",{header:"Return Date",cell:t=>{const n=T(t.getValue());return n?n.toLocaleDateString("en-GB"):"Invalid Date"},meta:{filterVariant:"date-range"},filterFn:"inDateRange"}),f.accessor("productName",{header:"Product Name",cell:t=>t.getValue()}),f.accessor("quantity",{header:"Qty",cell:t=>t.getValue(),meta:{filterVariant:"number-range",rangeMin:1,rangeMax:10,rangeStep:1},filterFn:"inNumberRange"}),f.accessor("reason",{header:"Reason",cell:t=>e.jsx(v,{lineClamp:2,children:t.getValue()})}),f.accessor("status",{header:"Status",cell:t=>{const n=t.getValue();let o="gray";return n==="Approved"?o="green":n==="Processed"?o="blue":n==="Pending"?o="orange":n==="Rejected"&&(o="red"),e.jsx(D,{style:{backgroundColor:`var(--mantine-color-${o}-1)`,borderLeft:`3px solid var(--mantine-color-${o}-6)`,padding:"6px 10px",borderRadius:"4px",color:`var(--mantine-color-${o}-9)`,fontWeight:500},children:n})}})],[]),y=(t,n,o)=>{const c=t.getValue(n);if(!c)return!1;const l=T(c);if(!l)return!1;l.setHours(0,0,0,0);const[w,P]=o;return!(w&&l<new Date(new Date(w).setHours(0,0,0,0))||P&&l>new Date(new Date(P).setHours(23,59,59,999)))},j=(t,n,o)=>{const c=t.getValue(n);if(typeof c!="number")return!1;const[l,w]=o;return!(l!==void 0&&c<l||w!==void 0&&c>w)},s=L({data:K,columns:I,state:{columnFilters:p,sorting:d,pagination:i},onColumnFiltersChange:m,onSortingChange:S,onPaginationChange:x,getCoreRowModel:J(),getFilteredRowModel:_(),getSortedRowModel:Z(),getPaginationRowModel:U(),filterFns:{inDateRange:y,inNumberRange:j},defaultColumn:{minSize:50,size:160,maxSize:500}});return e.jsxs(e.Fragment,{children:[e.jsxs($,{order:3,mb:"lg",children:["Returns for ",g]}),s.getState().columnFilters.length>0&&e.jsx(R,{justify:"flex-end",children:e.jsx(M,{style:{marginLeft:"auto"},variant:"filled",size:"xs",onClick:()=>s.resetColumnFilters(),mb:"md",leftSection:e.jsx(A,{size:14}),children:"Reset All Filters"})}),e.jsx(H,{radius:"md",shadow:"md",p:"xs",withBorder:!0,children:e.jsx(k,{children:e.jsxs(u,{highlightOnHover:!0,withColumnBorders:!0,verticalSpacing:"md",miw:700,children:[e.jsx(u.Thead,{children:s.getHeaderGroups().map(t=>e.jsx(u.Tr,{children:t.headers.map(n=>e.jsx(u.Th,{colSpan:n.colSpan,style:{width:n.getSize()},children:n.isPlaceholder?null:e.jsxs(D,{children:[e.jsxs(R,{justify:"space-between",wrap:"nowrap",gap:"xs",children:[e.jsx(v,{fw:500,lineClamp:1,style:{whiteSpace:"nowrap"},children:z(n.column.columnDef.header,n.getContext())}),n.column.getCanSort()&&e.jsx(F,{variant:"subtle",size:"xs",onClick:n.column.getToggleSortingHandler(),children:{asc:e.jsx(G,{size:14}),desc:e.jsx(W,{size:14})}[n.column.getIsSorted()]??e.jsx(Y,{size:14})})]}),n.column.getCanFilter()?e.jsx(D,{mt:4,children:e.jsx(X,{column:n.column})}):null]})},n.id))},t.id))}),e.jsxs(u.Tbody,{children:[s.getRowModel().rows.map(t=>e.jsx(u.Tr,{children:t.getVisibleCells().map(n=>e.jsx(u.Td,{style:{width:n.column.getSize()},children:z(n.column.columnDef.cell,n.getContext())},n.id))},t.id)),s.getRowModel().rows.length===0&&e.jsx(u.Tr,{children:e.jsx(u.Td,{colSpan:s.getAllColumns().length,children:e.jsx(v,{ta:"center",p:"md",children:"No returns found."})})})]})]})})}),e.jsxs(R,{justify:"space-between",mt:"md",children:[e.jsxs(v,{size:"sm",children:["Page ",s.getState().pagination.pageIndex+1," of"," ",s.getPageCount()||1]}),e.jsx(Q,{total:s.getPageCount()||1,value:s.getState().pagination.pageIndex+1,onChange:t=>s.setPageIndex(t-1),size:"sm"}),e.jsx(V,{size:"xs",data:["5","10","20"].map(t=>({label:`${t} rows`,value:t})),value:s.getState().pagination.pageSize.toString(),onChange:t=>{t&&s.setPageSize(Number(t))}})]})]})};export{ne as component};
