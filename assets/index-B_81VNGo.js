import{f as G,u as W,a2 as _,a as E,j as e,a3 as Y,B as S,h as U,O as R,X,n as Z,l as J,F as v,a4 as K,a5 as Q,y as ee,G as M,q as O,P as te,_ as ae,T as N,A as V,$ as H,r as z,L as re,a6 as se,a0 as F,a1 as ne,o as ie}from"./index-BdFAjZwO.js";import{c as oe,u as le,g as de,e as ce,h as ue,i as ge,I as B,T as x,f as k,a as xe,b as me,d as fe,P as pe,N as L}from"./index-DQJoQ2FV.js";var q={root:"m_7f854edf"};const he={position:{bottom:0,right:0},zIndex:_("modal"),withinPortal:!0},ve=U((i,{zIndex:t,position:s})=>({root:{"--affix-z-index":t==null?void 0:t.toString(),"--affix-top":R(s==null?void 0:s.top),"--affix-left":R(s==null?void 0:s.left),"--affix-bottom":R(s==null?void 0:s.bottom),"--affix-right":R(s==null?void 0:s.right)}})),A=G((i,t)=>{const s=W("Affix",he,i),{classNames:d,className:u,style:c,styles:D,unstyled:l,vars:g,portalProps:C,zIndex:I,withinPortal:m,position:j,...f}=s,p=E({name:"Affix",classes:q,props:s,className:u,style:c,classNames:d,styles:D,unstyled:l,vars:g,varsResolver:ve});return e.jsx(Y,{...C,withinPortal:m,children:e.jsx(S,{ref:t,...p("root"),...f})})});A.classes=q;A.displayName="@mantine/core/Affix";function T(i){if(!i)return null;const t=i.split("/");if(t.length===3){const s=parseInt(t[0],10),d=parseInt(t[1],10)-1,u=parseInt(t[2],10);if(!isNaN(s)&&!isNaN(d)&&!isNaN(u)){const c=new Date(u,d,s);if(c.getFullYear()===u&&c.getMonth()===d&&c.getDate()===s)return c}}return null}const je=[{orderId:"ORD001",orderDate:"15/01/2023",deliveryDate:"18/01/2023",productName:"Vanilla Swirls",quantity:2,unitPrice:15.99,status:"Delivered"},{orderId:"ORD002",orderDate:"20/02/2023",deliveryDate:"23/02/2023",productName:"Chocolate Dreams",quantity:1,unitPrice:22.5,status:"Shipped"},{orderId:"ORD003",orderDate:"10/03/2023",deliveryDate:void 0,productName:"Strawberry Clouds",quantity:5,unitPrice:12,status:"Pending"},{orderId:"ORD004",orderDate:"12/03/2023",deliveryDate:"12/03/2023",productName:"Minty Fresh",quantity:3,unitPrice:10.75,status:"Delivered"},{orderId:"ORD005",orderDate:"01/04/2023",deliveryDate:void 0,productName:"Caramel Crunch",quantity:2,unitPrice:18,status:"Cancelled"}],b=oe();function ye({column:i}){var d,u,c,D;const t=i.getFilterValue(),s=(d=i.columnDef.meta)==null?void 0:d.filterVariant;if(s==="number-range"){const[l,g]=v.useState(!1),C=t==null?void 0:t[0],I=t==null?void 0:t[1],[m,j]=v.useState(C),[f,p]=v.useState(I),o=(u=i.columnDef.meta)==null?void 0:u.rangeMin,a=(c=i.columnDef.meta)==null?void 0:c.rangeMax,r=((D=i.columnDef.meta)==null?void 0:D.rangeStep)??1;return v.useMemo(()=>{l||(j(t==null?void 0:t[0]),p(t==null?void 0:t[1]))},[t,l]),e.jsxs(F,{opened:l,onClose:()=>g(!1),position:"bottom-start",withArrow:!0,shadow:"md",trapFocus:!0,onOpen:()=>{j(t==null?void 0:t[0]),p(t==null?void 0:t[1])},children:[e.jsx(F.Target,{children:e.jsx(V,{variant:l?"filled":i.getIsFiltered()?"light":"default",onClick:()=>g(n=>!n),size:"input-xs",title:"Set number range",style:{lineHeight:1},children:e.jsx(B,{size:"1rem"})})}),e.jsxs(F.Dropdown,{p:"sm",style:{minWidth:230},children:[" ",e.jsxs(S,{children:[e.jsxs(M,{grow:!0,align:"flex-start",gap:"xs",children:[" ",e.jsx(L,{label:"Min",placeholder:o!==void 0?`Min: ${o}`:"Minimum",value:m===void 0?"":m,onChange:n=>j(n===""?void 0:Number(n)),min:o,max:f??a,step:r,size:"xs",variant:"filled",style:{flex:1}}),e.jsx(L,{label:"Max",placeholder:a!==void 0?`Max: ${a}`:"Maximum",value:f===void 0?"":f,onChange:n=>p(n===""?void 0:Number(n)),min:m??o,max:a,step:r,size:"xs",variant:"filled",style:{flex:1}})]}),e.jsxs(M,{justify:"flex-end",mt:"md",children:[e.jsx(O,{variant:"default",size:"xs",onClick:()=>{j(void 0),p(void 0),i.setFilterValue([void 0,void 0]),g(!1)},children:"Clear"}),e.jsx(O,{size:"xs",onClick:()=>{let n=m,h=f;i.setFilterValue([n,h]),g(!1)},children:"Done"})]})]})]})]})}if(s==="date-range"){const l=t||[null,null];return e.jsx(ne,{type:"range",size:"xs",placeholder:"Pick dates range",value:l,onChange:g=>i.setFilterValue(g),clearable:!0,popoverProps:{withinPortal:!0},style:{minWidth:220}})}return i.id==="status"?e.jsx(H,{size:"xs",placeholder:`Filter by ${i.columnDef.header}`,data:["Pending","Shipped","Delivered","Cancelled"].map(l=>({label:l,value:l})),value:t||null,onChange:l=>i.setFilterValue(l),clearable:!0}):e.jsx(ie,{size:"xs",placeholder:`Search ${i.columnDef.header}...`,value:t??"",onChange:l=>i.setFilterValue(l.target.value),variant:"filled"})}const Ce=function(){const t=X({from:"/customer/$customerId"}),s=(t==null?void 0:t.name)||"Customer",d=t==null?void 0:t.id,u=Z(),c=J(),[D,l]=v.useState([]),[g,C]=v.useState([]),[I,m]=v.useState({pageIndex:0,pageSize:5}),j=v.useMemo(()=>[b.accessor("orderId",{header:"Order ID",cell:a=>a.getValue()}),b.accessor("orderDate",{header:"Order Date",cell:a=>{const r=T(a.getValue());return r?r.toLocaleDateString("en-GB"):"Invalid Date"},meta:{filterVariant:"date-range"},filterFn:"inDateRange"}),b.accessor("deliveryDate",{header:"Delivery Date",cell:a=>{const r=a.getValue();if(!r)return"N/A";const n=T(r);return n?n.toLocaleDateString("en-GB"):"Invalid Date"},meta:{filterVariant:"date-range"},filterFn:"inDateRange"}),b.accessor(a=>a.quantity*a.unitPrice,{id:"invoicePrice",header:"Invoice Price",cell:a=>e.jsxs(K,{align:"center",gap:"xs",children:[e.jsx(Q,{size:"0.9rem"}),a.getValue().toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),meta:{filterVariant:"number-range",rangeMin:0,rangeMax:1e3,rangeStep:.01},filterFn:"inNumberRange"}),b.accessor("status",{header:"Status",cell:a=>{const r=a.getValue();let n="gray";return r==="Delivered"?n="green":r==="Shipped"?n="blue":r==="Pending"?n="orange":r==="Cancelled"&&(n="red"),e.jsx(S,{style:{backgroundColor:`var(--mantine-color-${n}-1)`,borderLeft:`3px solid var(--mantine-color-${n}-6)`,padding:"6px 10px",borderRadius:"4px",color:`var(--mantine-color-${n}-9)`,fontWeight:500},children:r})}})],[]),f=(a,r,n)=>{const h=a.getValue(r);if(!h)return!1;const y=T(h);if(!y)return!1;y.setHours(0,0,0,0);const[w,$]=n;if(w){const P=new Date(w);if(P.setHours(0,0,0,0),y<P)return!1}if($){const P=new Date($);if(P.setHours(23,59,59,999),y>P)return!1}return!0},p=(a,r,n)=>{const h=a.getValue(r);if(typeof h!="number")return!1;const[y,w]=n;return!(y!==void 0&&h<y||w!==void 0&&h>w)},o=le({data:je,columns:j,state:{columnFilters:D,sorting:g,pagination:I},onColumnFiltersChange:l,onSortingChange:C,onPaginationChange:m,getCoreRowModel:ge(),getFilteredRowModel:ue(),getSortedRowModel:ce(),getPaginationRowModel:de(),filterFns:{inDateRange:f,inNumberRange:p},defaultColumn:{minSize:40,size:180,maxSize:800}});return e.jsxs(e.Fragment,{children:[e.jsxs(ee,{order:3,mb:"lg",children:["Orders for ",s]}),o.getState().columnFilters.length>0&&e.jsx(M,{justify:"flex-end",children:e.jsx(O,{style:{marginLeft:"auto"},variant:"filled",size:"xs",onClick:()=>o.resetColumnFilters(),mb:"md",leftSection:e.jsx(B,{size:14}),children:"Reset All Filters"})}),e.jsx(te,{radius:"md",shadow:"md",p:"xs",withBorder:!0,children:e.jsx(ae,{style:{padding:0},children:e.jsxs(x,{highlightOnHover:!0,withColumnBorders:!0,verticalSpacing:"md",children:[e.jsx(x.Thead,{children:o.getHeaderGroups().map(a=>e.jsx(x.Tr,{children:a.headers.map(r=>e.jsx(x.Th,{colSpan:r.colSpan,style:{width:r.getSize()},children:r.isPlaceholder?null:e.jsxs(S,{children:[e.jsxs(M,{justify:"space-between",wrap:"nowrap",gap:"xs",children:[e.jsx(N,{fw:500,lineClamp:1,style:{whiteSpace:"nowrap"},children:k(r.column.columnDef.header,r.getContext())}),r.column.getCanSort()&&e.jsx(V,{variant:"subtle",size:"xs",onClick:r.column.getToggleSortingHandler(),children:{asc:e.jsx(me,{size:14}),desc:e.jsx(xe,{size:14})}[r.column.getIsSorted()]??e.jsx(fe,{size:14})})]}),r.column.getCanFilter()?e.jsx(S,{mt:4,children:e.jsx(ye,{column:r.column})}):null]})},r.id))},a.id))}),e.jsxs(x.Tbody,{children:[o.getRowModel().rows.map(a=>e.jsx(x.Tr,{onClick:()=>{d&&u({to:"/customer/$customerId/orders/$orderId/details",params:{customerId:d,orderId:a.original.orderId}})},style:{cursor:"pointer"},children:a.getVisibleCells().map(r=>e.jsx(x.Td,{style:{width:r.column.getSize(),paddingTop:"10px",paddingBottom:"10px"},children:k(r.column.columnDef.cell,r.getContext())},r.id))},a.id)),o.getRowModel().rows.length===0&&e.jsx(x.Tr,{children:e.jsx(x.Td,{colSpan:o.getAllColumns().length,children:e.jsx(N,{ta:"center",p:"md",children:"No orders found."})})})]})]})})}),e.jsxs(M,{justify:"space-between",mt:"md",children:[e.jsxs(N,{size:"sm",children:["Page ",o.getState().pagination.pageIndex+1," of"," ",o.getPageCount()]}),e.jsx(pe,{total:o.getPageCount(),value:o.getState().pagination.pageIndex+1,onChange:a=>o.setPageIndex(a-1),size:"sm"}),e.jsx(H,{size:"xs",data:["5","10","20"].map(a=>({label:`${a} rows`,value:a})),value:o.getState().pagination.pageSize.toString(),onChange:a=>o.setPageSize(Number(a))})]}),d&&e.jsx(A,{position:{bottom:70,right:20},children:e.jsx(S,{style:{borderRadius:"9999px",boxShadow:c.shadows.md},children:e.jsx(V,{component:re,to:`/customer/${d}/orders/add`,variant:"filled",style:{width:z(56),height:z(56)},radius:"xl","aria-label":"Add new order",color:c.primaryColor,children:e.jsx(se,{style:{width:z(28),height:z(28)}})})})})]})};export{Ce as component};
