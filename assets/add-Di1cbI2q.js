import{j as e,n as $,m as B,t as V,K as b,W as q,y as I,G as t,A as f,L as G,X as C,w as M,C as d,D as R,E as O,F as U,P as g,Y as H,S as P,x as p,Z as L,z as A,_ as W,$ as K,H as N,o as X,a0 as Y,B as Z,T as S,a1 as _,a2 as w,q as k,a3 as J,a4 as Q,r as D,a5 as ee,a6 as l}from"./index-BqrwD2Al.js";const ie=l.object({name:l.string().min(1,{message:"Product name is required"}),description:l.string().min(1,{message:"Description is required"}),price:l.number().min(.01,{message:"Price must be greater than 0"}),image:l.instanceof(File).nullable().optional(),existingImage:l.string().optional(),vat:l.number().min(0,"VAT cannot be negative").max(100,"VAT cannot exceed 100").nullable().optional(),discount:l.number().min(0,"Discount cannot be negative").max(100,"Discount cannot exceed 100").nullable().optional()});function u({label:x,value:i,icon:o,isLargeText:c}){return e.jsxs(t,{wrap:"nowrap",gap:"xs",align:"flex-start",mb:"sm",children:[o&&e.jsx(p,{variant:"light",size:"md",mt:D(2),children:o}),e.jsxs(P,{gap:0,style:{flexGrow:1},children:[e.jsx(S,{fz:"xs",tt:"uppercase",c:"dimmed",children:x}),e.jsx(S,{fz:c?"lg":"sm",fw:c?600:500,style:{whiteSpace:c?"normal":"pre-wrap"},children:i||"N/A"})]})]})}function se({addMode:x=!0,productData:i}){const o=$(),{toggleColorScheme:c}=B(),h=V("light"),[a,j]=b.useState(x),r=x,y=!r&&!a,n=q({initialValues:!r&&i?{name:i.name,description:i.description,price:i.price,image:null,existingImage:i.image,vat:i.vat!==void 0?i.vat:null,discount:i.discount!==void 0?i.discount:null}:{name:"",description:"",price:0,image:null,existingImage:void 0,vat:null,discount:null},validate:Q(ie)});b.useEffect(()=>{!r&&i&&(n.setValues({name:i.name,description:i.description,price:i.price,image:null,existingImage:i.image,vat:i.vat!==void 0?i.vat:null,discount:i.discount!==void 0?i.discount:null}),n.resetDirty())},[r,i,n.setValues,n.resetDirty]);const T=s=>{if(r){const m={id:ee(),name:s.name,description:s.description,price:Number(s.price),image:s.image?s.image.name:"https://picsum.photos/seed/newproduct/300/200",vat:s.vat!==null&&s.vat!==void 0?Number(s.vat):void 0,discount:s.discount!==null&&s.discount!==void 0?Number(s.discount):void 0};console.log("New Product Added:",m),alert(`Product ${m.name} would be added.`),o({to:"/products"})}else if(i){const m={...i,name:s.name,description:s.description,price:Number(s.price),image:s.image?s.image.name:s.existingImage||i.image,vat:s.vat!==null&&s.vat!==void 0?Number(s.vat):void 0,discount:s.discount!==null&&s.discount!==void 0?Number(s.discount):void 0};console.log("Product Updated:",m),alert(`Product ${m.name} would be updated.`),j(!1),o({to:"/products/$productId/details",params:{productId:i.id}})}},v=(i==null?void 0:i.name)||"Product",z=r?"Add New Product":y?v:`Edit: ${v}`,E=r?I:b.Fragment,F=r?{header:{height:70},padding:"md"}:{};return e.jsxs(E,{...F,children:[r&&e.jsx(I.Header,{p:"sm",style:s=>({background:h==="dark"?s.colors.dark[5]:`linear-gradient(45deg, ${s.colors.primaryColor[4]}, ${s.colors.primaryColor[6]})`,boxShadow:s.shadows.sm,display:"flex",alignItems:"center"}),children:e.jsxs(t,{justify:"space-between",style:{flexGrow:1},children:[e.jsx(t,{gap:"xs",children:e.jsx(f,{component:G,to:"/products",variant:"transparent",title:"Back to Products",size:"lg",children:e.jsx(C,{size:"1.5rem",color:"white"})})}),e.jsxs(t,{align:"center",children:[e.jsx(M,{size:"1.8rem",color:"white",style:{marginRight:"var(--mantine-spacing-xs)"}}),e.jsx(d,{order:3,c:"white",children:z})]}),e.jsx(f,{variant:"transparent",onClick:()=>c(),title:"Toggle color scheme",size:"lg",children:h==="dark"?e.jsx(R,{size:"1.2rem",color:"white"}):e.jsx(O,{size:"1.2rem",color:"white"})})]})}),e.jsx(I.Main,{style:s=>({backgroundColor:r||i?h==="dark"?s.colors.dark[8]:s.colors.gray[1]:void 0}),children:e.jsx(U,{size:"md",py:r?"xl":"sm",px:0,children:e.jsxs(g,{withBorder:r||a,shadow:r||a?"md":"none",p:"lg",radius:"md",children:[!r&&i&&e.jsxs(e.Fragment,{children:[!a&&e.jsx(t,{justify:"flex-end",mb:"xs",children:e.jsx(f,{variant:"outline",color:"blue",onClick:()=>j(!0),title:"Edit Product",children:e.jsx(H,{size:18})})}),e.jsx(d,{order:2,mb:"md",children:v})]}),r&&!i&&!a&&e.jsx(d,{order:3,mb:"lg",ta:"center",children:z}),y&&i?e.jsxs(P,{gap:"xl",children:[n.values.existingImage&&e.jsxs(g,{withBorder:!0,p:"md",radius:"md",shadow:"xs",children:[e.jsx(d,{order:4,c:"dimmed",mb:"sm",children:e.jsxs(t,{gap:"xs",children:[e.jsx(p,{variant:"light",children:e.jsx(L,{size:"1.1rem"})}),"Image"]})}),e.jsx(A,{src:n.values.existingImage,alt:n.values.name,maw:300,mah:300,fit:"contain",radius:"sm",style:{margin:"auto"}})]}),e.jsxs(g,{withBorder:!0,p:"md",radius:"md",shadow:"xs",children:[e.jsx(d,{order:4,c:"dimmed",mb:"sm",children:e.jsxs(t,{gap:"xs",children:[e.jsx(p,{variant:"light",children:e.jsx(W,{size:"1.1rem"})}),"General Information"]})}),e.jsx(u,{label:"Product Name",value:n.values.name,isLargeText:!0}),e.jsx(u,{label:"Description",value:n.values.description})]}),e.jsxs(g,{withBorder:!0,p:"md",radius:"md",shadow:"xs",children:[e.jsx(d,{order:4,c:"dimmed",mb:"sm",children:e.jsxs(t,{gap:"xs",children:[e.jsx(p,{variant:"light",children:e.jsx(K,{size:"1.1rem"})}),"Pricing Details"]})}),e.jsxs(N,{cols:{base:1,sm:3},children:[e.jsx(u,{label:"Price",value:`£${Number(n.values.price).toFixed(2)}`}),e.jsx(u,{label:"VAT",value:n.values.vat!==null&&n.values.vat!==void 0?`${n.values.vat}%`:"N/A"}),e.jsx(u,{label:"Discount",value:n.values.discount!==null&&n.values.discount!==void 0?`${n.values.discount}%`:"N/A"})]})]})]}):e.jsxs("form",{onSubmit:n.onSubmit(T),children:[e.jsxs(P,{gap:"md",children:[e.jsx(X,{label:"Product Name",placeholder:"Enter product name",required:!0,...n.getInputProps("name")}),e.jsx(Y,{label:"Description",placeholder:"Enter product description",required:!0,minRows:3,autosize:!0,...n.getInputProps("description")}),n.values.existingImage&&!n.values.image&&e.jsxs(Z,{mb:"xs",children:[e.jsx(S,{size:"sm",fw:500,children:"Current Image:"}),e.jsx(A,{src:n.values.existingImage,alt:"Current product image",width:80,height:80,fit:"contain",radius:"sm"})]}),e.jsx(_,{label:n.values.existingImage?"Change Product Image (Optional)":"Product Image (Optional)",placeholder:"Upload an image",accept:"image/*",...n.getInputProps("image")}),e.jsxs(N,{cols:3,spacing:"md",children:[e.jsx(w,{label:"Price (£)",placeholder:"0.00",required:!0,min:.01,step:.01,decimalScale:2,fixedDecimalScale:!0,...n.getInputProps("price")}),e.jsx(w,{label:"VAT (%)",placeholder:"e.g., 20",min:0,max:100,step:1,allowDecimal:!1,...n.getInputProps("vat")}),e.jsx(w,{label:"Discount (%)",placeholder:"e.g., 10",min:0,max:100,step:1,allowDecimal:!1,...n.getInputProps("discount")})]})]}),(r||a)&&e.jsxs(t,{justify:"flex-end",mt:"xl",children:[e.jsx(k,{variant:"default",onClick:()=>{!r&&a?(j(!1),i&&(n.setValues({name:i.name,description:i.description,price:i.price,image:null,existingImage:i.image,vat:i.vat!==void 0?i.vat:null,discount:i.discount!==void 0?i.discount:null}),n.resetDirty())):o({to:"/products"})},leftSection:e.jsx(C,{size:14}),children:r?"Cancel":"Cancel Edit"}),e.jsx(k,{type:"submit",leftSection:e.jsx(J,{size:14}),children:r?"Save Product":"Update Product"})]})]})]})})})]})}const re=()=>e.jsx(se,{addMode:!0});export{se as AddProductPage,re as component};
